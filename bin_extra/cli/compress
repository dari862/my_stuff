#!/bin/sh
if [ "$#" -eq 0 ]; then
    echo "Usage: $(basename "$0") <archive_name.ext> [files_to_compress...]"
    exit 1
fi

ARCHIVE_NAME="${1:-}"
SOURCE=""

if [ "$#" -eq 1 ]; then
    SOURCE="${ARCHIVE_NAME%%.*}"
    if [ ! -e "$SOURCE" ]; then
        echo "Error: Only one argument provided, but '$SOURCE' does not exist."
        exit 1
    fi
fi

shift

case "$ARCHIVE_NAME" in
    *.tar.gz)  tar -cvzf "$ARCHIVE_NAME" "$SOURCE" "$@";;
    *.tar.bz2) tar -cvjf "$ARCHIVE_NAME" "$SOURCE" "$@" ;;
    *.zip)     zip -9r "$ARCHIVE_NAME" "$SOURCE" "$@" ;;
    *.7z)      7z a -mx9 "$ARCHIVE_NAME" "$SOURCE" "$@" ;;
    *)
        echo "Error: Invalid or unsupported file extension."
        exit 1
        ;;
esac
