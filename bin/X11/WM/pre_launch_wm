#!/bin/sh

. "$__distro_path_lib"
. "${__distro_path_root}/lib/common/WM"
. "${__distro_path_root}/lib/common/openbox"

mc-session start
mc-session db &

if mkdir -p "/tmp/$USER";then
	chmod 700 "/tmp/$USER"
else
	echo "$0: ERROR failed to mkdir /tmp/$USER"
fi

if [ ! -f "${WM_config_dir}/menu_picked" ];then
	show_em(){
		echo "[ERROR] $0 ${sourced_file}: $1"
		exit 1
	}
	_style="default"
	_panel_name_="$("${__distro_path_root}"/bin/X11/WM/panel_picker)"
	sourced_file="at style_file_builder"
	. "${__distro_path_root}"/lib/Style/style_file_builder
	sourced_file="at style_setter"
	. "${__distro_path_root}"/lib/Style/style_setter
	sourced_file=""
	touch "${WM_config_dir}/menu_picked"
fi

if [ ! -f "${Distro_config_file}" ];then
	cp -r "${__distro_path_root}/skel/.config/WM_common_config/Distro_config" "$WM_config_dir"
fi

dotscreenlayout_profile="$(ls ~/.screenlayout/*.sh 2>/dev/null | head -1 || :)"
if [ -n "$dotscreenlayout_profile" ];then
	"$dotscreenlayout_profile"
elif [ -f "$display_script" ];then
	"$display_script"
else
	"${__distro_path_root}"/bin/X11/WM/displayselect auto noninteractive
fi

#"${__distro_path_root}"/bin/X11/WM/displayselect watch &

"${__distro_path_root}"/bin/not_add_2_path/restore_BG

#polkit-session start &

notification-d-session start &

file-manager-session start &

