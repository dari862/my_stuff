#!/bin/sh
set -e

. "$__distro_path_lib"
. "${__distro_path_root}/lib/common/WM"
. "${Distro_config_file}"

if [ "$_panel_name_" = "polybar" ];then
	"${__distro_path_root}"/bin/X11/polybar/polybar_workspace_fixer
fi

clipboard-manager-session stop
#audio-session stop
power-manager-session stop

if [ "$_panel_name_" = "polybar" ];then
	tint2-session stop
elif [ "$_panel_name_" = "tint2" ] && command -v polybar-session >/dev/null 2>&1;then
	polybar-session stop
fi

sleep 0.5

conky-session restart &
notification-d-session restart &
#plank-session restart &

if [ "$_panel_name_" = "polybar" ];then
	nmcli networking on || printf '%s\n' "ncmcli: Failed to enable networking"
   	polybar-session restart
   	power-manager-session restart &
   	clipboard-manager-session start 3 &
elif [ "$_panel_name_" =  "tint2" ];then
	#audio-session start
	tint2-session restart
	power-manager-session start 3 &
	clipboard-manager-session start-gui 3 &
fi
