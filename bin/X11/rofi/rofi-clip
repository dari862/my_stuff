#!/bin/sh
# if this line exist script will be part of hub script.
# Import Current Theme
. "/usr/share/my_stuff/lib/common/Distro_path"
. "${__distro_path_root}/lib/common/WM"
. "${Distro_config_file}"
. "${script_config_path}/clipmanager/config.ini" 

count=1
: > "${clip_path}/listofclip"
if pgrep clipmanager >/dev/null 2>&1;then
	clip2cp="$(for f in "$history_path"/*; do
				echo "${count}: $(head -n 1 "$f" | cut -c1-80)"
				echo "${list_of_files}${count}:${f}" >> "${clip_path}/listofclip"
				count=$((count + 1))
			done | rofi -p "Clipboard Entries" -no-config -no-lazy-grab -dmenu -r -i -l 20 -theme "$HOME/.config/rofi/$ROFI_STYLE"/runner.rasi | awk -F: '{print $1}')"
	[ -z "$clip2cp" ] && exit
	selected_file="$(cat "${clip_path}/listofclip" | grep -w "^$clip2cp" | awk -F: '{print $2}')"
	cat "${selected_file}" | xclip -selection clipboard
else
	rofi -e "$0: ERROR clipmanager is not running." -theme "$HOME/.config/rofi/$ROFI_STYLE"/runner.rasi
	exit 1
fi
