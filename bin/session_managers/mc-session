#!/bin/sh
# work on this : high IO pressure from mpd `cat /proc/pressure/io` only on debian 13
. "$__distro_path_lib"
mpdconf_path="$HOME/.config/mpd/mpd.conf"

stop() {
	mpd --kill || "${__distro_path_root}"/bin/WM/kill_process.sh mpd
}

build_db() {
	sleep 2
	cd ~/Music
	mpc -q add *
}

start() {
	pidof -q mpd || setsid mpd ${mpdconf_path} &
}

case "${1}" in
	""|restart)
		stop
		start		
	;;
	start)
		start		
	;;
	stop)	
		stop	
	;;
	db)	
		build_db	
	;;
	*)	
		echo "Usage: mpd-session [start|stop|restart]"
	;;
esac
