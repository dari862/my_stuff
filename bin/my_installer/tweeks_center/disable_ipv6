#!/bin/sh
# need superuser : called by my-installer
if [ "$(id -u)" -eq 0 ];then
	_SUPERUSER=""
else
	_SUPERUSER="my-superuser"
fi

disable_ipv6_conf="/etc/sysctl.d/90-disable_ipv6.conf"

if [ -f "${disable_ipv6_conf}" ];then # enabled
	tweek_enabled=true 
elif [ "$1" = "--is-enable" ] || [ "$check_tweek" = "true" ];then # disabled and only check
	tweek_enabled=false
else
	say "disable_ipv6"
	echo "net.ipv6.conf.all.disable_ipv6 = 1" | ${_SUPERUSER} tee "${disable_ipv6_conf}" >/dev/null 2>&1
	echo "net.ipv6.conf.default.disable_ipv6 = 1" | ${_SUPERUSER} tee -a "${disable_ipv6_conf}" >/dev/null 2>&1
	echo "net.ipv6.conf.lo.disable_ipv6 = 1" | ${_SUPERUSER} tee -a "${disable_ipv6_conf}" >/dev/null 2>&1
		
	${_SUPERUSER} sysctl -p "${disable_ipv6_conf}"
fi
